{"tf_id": "SUB-006", "file": "tests/fixtures/agent/ambiguous_sub.py", "lineno": 4, "code_frame": "# ruff: noqa: I001\nimport subprocess\n\n\ndef run_cmd(cmd: str) -> int:\n    # ambiguous: uses shell=True which is risky\n    return subprocess.run(cmd, shell=True).returncode\n", "allowed_transforms": ["Add check=True and capture/timeout"], "decision_rule": "Apply when adding guards is safe and idempotent", "hints": ["Require explicit env, check return codes", "Avoid shell=True unless justified"]}